<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1977) -->
<HEAD><!--#include virtual="/header_includes/java_head.html" -->



<TITLE>Using Ribo</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1977)">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" >
<BLOCKQUOTE> 
  <DIV> 
    <DIV> 
      <P> <a href="ribo-1.html"><img align=BOTTOM src=prev.gif></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000A0" face="Verdana, Arial, Helvetica, sans-serif"><b><font size="+4">Using 
        Ribo </font></b> </font></P>
    </DIV>
    <HR noshade SIZE=2 ALIGN=LEFT>
    <p> This document explains how to use the Ribo utility. It contains these 
      sections:</p>
  </DIV>
  <ul>
    <li><a href="ribo-2.html#MARKER-2-18">What is Ribo?</a></li>
    <li><a href="ribo-2.html#MARKER-2-19">Starting Ribo</a></li>
    <li><a href="ribo-2.html#MARKER-2-22">Capturing Data</a> 
      <ul>
        <li><a href="ribo-2.html#MARKER-2-24">Syntax and Parameters</a></li>
        <li><a href="ribo-2.html#MARKER-2-25">Examples</a></li>
      </ul>
    </li>
    <li><a href="ribo-2.html#MARKER-2-26">Translating Data</a></li>
    <ul>
      <li><a href="ribo-2.html#MARKER-2-27">Examples</a></li>
    </ul>
    <li><a href="ribo-2.html#MARKER-2-28">Using the Ribo GUI</a></li>
    <li><a href="ribo-2.html#filters">Using Filters</a></li>
    <li><a href="ribo-2.html#knownproblems">Known Problems</a></li>
  </ul>
  <h1><font face="Times New Roman, Times, serif" color="#0000A0"><a name=MARKER-2-18></a>What 
    is Ribo?</font></h1>
  <DIV> 
    <P>The Ribo utility captures, translates, and displays the Tabular Data Stream<SUP>TM</SUP> 
      (TDS) protocol flowing between a TDS client and TDS server. TDS clients 
      include jConnect<SUP>TM</SUP> for JDBC<SUP>TM</SUP>, isql, jisql, and Open 
      Client<SUP>TM</SUP>. TDS servers include Adaptive Server&reg; Enterprise, 
      Adaptive Server Anywhere, Adaptive Server IQ, and Open Server<SUP>TM</SUP>.</P>
    <P><font color="#CC0000"><b>For more information about TDS tokens, see the 
      TDS 5.0 Functional Specification at <a href="http://www.sybase.com/products/TDSfunctionalSpecForm.html">http://www.sybase.com/products/TDSfunctionalSpecForm.html</a>.</b></font></P>
    <P>Ribo has three modes:</P>
    <UL compact>
      <LI VALUE="&middot; ">Capture a TDS protocol stream to a file 
      <LI VALUE="&middot; ">Translate a captured file to the TDS protocol's text 
        representation 
      <LI VALUE="&middot; ">Capture a TDS protocol's stream to a file and translate 
        the protocol's text representation to the screen or a GUI window "on-the-fly" 
    </UL>
    <h1> <A NAME=MARKER-2-19></A><font face="Times New Roman, Times, serif" color="#0000A0">Starting 
      Ribo </font> </h1>
    <P></P>
    <P>Ribo ships with a UNIX shell script and a MS-DOS <I>.bat</I> file. Before 
      you use Ribo:</P>
    <OL compact>
      <LI VALUE="1. ">Give yourself execute permissions on the UNIX script. At 
        a command prompt where the Ribo files are installed, type: 
        <blockquote> 
          <DIV> 
            <PRE>
chmod +x Ribo
</PRE>
          </DIV>
        </blockquote>
    </OL>
  </DIV>
  <DIV> 
    <OL compact>
      <LI VALUE="2. ">Set the JAVA_HOME and RIBO_HOME environment variables. For 
        example: 
        <blockquote> 
          <DIV> 
            <PRE>
set RIBO_HOME=c:\jutils-2_0\ribo
set JAVA_HOME=c:\jdk1.1.8
</PRE>
          </DIV>
        </blockquote>
    </OL>
  </DIV>
  <DIV> 
    <h1> <a name=MARKER-2-22></a><font face="Times New Roman, Times, serif" color="#0000A0">Capturing 
      Data</font> </h1>
    <P></P>
    <P>To use Ribo to capture TDS protocol data and save that data to a file, 
      enter the following from a UNIX, Linux, or DOS command window: </P>
  </DIV>
  <blockquote> 
    <DIV> 
      <PRE>
Ribo &lt;command_line_options&gt;
</PRE>
    </DIV>
  </blockquote>
  <DIV> 
    <h2><I> <A NAME=MARKER-2-24></A></I><font face="Times New Roman, Times, serif" color="#0000A0">Syntax 
      and Parameters</font> </h2>
    <P></P>
    <P>Ribo uses the following syntax and command line options.</P>
    <PRE>
    Ribo [-l &lt;listen_port&gt;] [-s &lt;server_host&gt;] [-p &lt;server_port&gt;] 
	[-c &lt;capture_file_prefix&gt;] [-t &lt;trans_file_prefix&gt;] [-x &lt;charset&gt;]<br>	[-gui] [-d] [-f &lt;filter_file&gt;] [-h]</pre>
    <TABLE BORDER=1 CELLPADDING="5" cellspacing="0">
      <CAPTION> <b>Table 1: &nbsp<a name=MARKER-9-13></a>Ribo command line parameters</b><br>
      </CAPTION>
      <TR VALIGN=TOP> 
        <TH> 
          <P> Parameter</P>
        </TH>
        <TH> 
          <P> Description</P>
        </TH>
        <TH> 
          <P> Default</P>
        </TH>
      </TR>
      <TR VALIGN=TOP> 
        <TD> 
          <P> <B>-l </B></P>
        </TD>
        <TD> 
          <P> The port on which to listen. </P>
        </TD>
        <TD> 
          <P> 5005</P>
        </TD>
      </TR>
      <TR VALIGN=TOP> 
        <TD> 
          <P> <B>-s</B></P>
        </TD>
        <TD> 
          <P> The host name of the database server.</P>
        </TD>
        <TD> 
          <P> localhost</P>
        </TD>
      </TR>
      <TR VALIGN=TOP> 
        <TD> 
          <P> <B>-p</B></P>
        </TD>
        <TD> 
          <P> The port number of the database server.</P>
        </TD>
        <TD> 
          <P> 2638</P>
        </TD>
      </TR>
      <TR VALIGN=TOP> 
        <TD> 
          <P> <B>-c</B></P>
        </TD>
        <TD> 
          <P> By default, Ribo captures TDS data to a file. This option lets you 
            specify the prefix added to the generated file name of the captured 
            data. This file can be used by technical support personnel to help 
            you troubleshoot problems with your system.</P>
        </TD>
        <TD> 
          <P> <I>capX.tds</I></P>
          <P> where &quot;X&quot; is the generated file name. </P>
        </TD>
      </TR>
      <TR VALIGN=TOP> 
        <TD><b>-x</b></TD>
        <TD> 
          <p>Lets you specify the default character set conversion to use when dumping TDS files. 
<ul>
            <li>The character set you specify must match a character set in be 
              one supported by Sybase.</li> 
<li>If Ribo finds character set information in the LOGIN record, that information overrides the charset you specify using <b>-x</b></li>. 
<li>If you do not specify 
          a character set using <b>-x</b>, and the TDS file contains no character 
          set information, no character set translation is done. Text is written 
          using the the server’s default character set.</li></ul> 
          <p>For more information about character sets and character-set conversion, 
            see Chapter 2 of the<i> jConnect for JDBC Programmer’s Reference</i> 
            or Chapter 7 of the <i>Sybase Adaptive Server Enterprise Version 12.0 
            Installation Guide</i>.</p>
        </TD>
        <TD>n/a</TD>
      </TR>
      <TR VALIGN=TOP> 
        <TD> 
          <P> <B>-t</B></P>
        </TD>
        <TD> 
          <P> Translates captured data to the TDS protocol's text representation 
            and saves it to a file. This option lets you specify the prefix added 
            to the generated file name of the translated data.</P>
        </TD>
        <TD> 
          <P> <I>outX.tds</I></P>
          <P> where "X" is the generated file name.</P>
        </TD>
      </TR>
      <TR VALIGN=TOP> 
        <TD> 
          <P> <B>-gui</B></P>
        </TD>
        <TD> 
          <P> Invokes the Ribo GUI, which you can use to:</P>
          <UL>
            <LI>Specify command line parameters 
            <LI>Start and stop the capturing process 
            <LI>View translated data "on the fly" as it is being analyzed 
          </ul>
        </TD>
        <TD> 
          <P> n/a</P>
        </TD>
      </TR>
      <TR VALIGN=TOP> 
        <TD> 
          <P> <B>-d</B></P>
        </TD>
        <TD> 
          <P> Displays translated data while the data is being captured. If you 
            are using the Ribo GUI, the data displays in a separate window. If 
            you are not using the GUI, the data displays on the screen.</P>
        </TD>
        <TD> 
          <P> n/a</P>
        </TD>
      </TR>
      <TR VALIGN=TOP> 
        <TD> 
          <P> -<b>f</b></P>
        </TD>
        <TD> 
          <P>Allows you to specify a user-defined, previously saved filter.</P>
        </TD>
        <TD> 
          <P> n/a</P>
        </TD>
      </TR>
      <TR VALIGN=TOP> 
        <TD> 
          <P> <B>-h</B></P>
        </TD>
        <TD> 
          <P> Displays help on Ribo usage.</P>
        </TD>
        <TD> 
          <P> n/a</P>
        </TD>
      </TR>
    </TABLE>
    <H3><I> <A NAME=MARKER-2-25></A></I><font face="Times New Roman, Times, serif" color="#0000A0">Examples</font> 
    </H3>
    <P></P>
    <P>To have Ribo listen on local machine port 2638 and forward the data to 
      another machine--rubicon, port 2525--you would enter:</P>
  </DIV>
  <blockquote> 
    <DIV> 
      <PRE>
Ribo -l 2638 -s rubicon -p 2525
</PRE>
    </DIV>
  </blockquote>
  <DIV> 
    <p>To have Ribo listen on a local machine port 4000, display the data in the 
      gui as it is being captured, and filter the data using a script you have 
      created named <i>myscript.filter</i>, you would enter:</p>
  </DIV>
  <blockquote> 
    <DIV> 
      <pre>Ribo -gui -l 4000 -f myscript.filter -d</pre>
    </DIV>
  </blockquote>
  <DIV></DIV>
  <DIV> 
    <h1> <a name=MARKER-2-26></a><font color="#0000A0" face="Times New Roman, Times, serif">Translating 
      Data</font> </h1>
    <P></P>
    <P>To analyze captured TDS protocol data and save the text representation 
      of that data to a file, enter: </P>
  </DIV>
  <blockquote> 
    <DIV> 
      <PRE>
Ribo &lt;<EM>input_capture_file</EM>&gt; &lt;<EM>output_file</EM>&gt;
</PRE>
    </DIV>
  </blockquote>
  <DIV> 
    <P>where <VAR>&lt;input_capture_file&gt;</VAR> is the name of the file from 
      which to analyze previously captured data and <VAR>&lt;output_file&gt; is 
      </VAR>the file name under which to save the translated data. If you do not 
      specify an output file, the translated data is sent to <B>stdout</B>.</P>
    <P>The output file displays:</P>
    <UL compact>
      <LI VALUE="&middot; ">SQL statements sent to the server 
      <LI VALUE="&middot; ">Parameters sent to the server 
      <LI VALUE="&middot; ">Results returned from the server 
    </UL>
    <H3><I> <a name=MARKER-2-27></a></I><font face="Times New Roman, Times, serif" color="#0000A0">Examples</font> 
    </H3>
    <P></P>
    <P>To have Ribo listen on local machine port 2638, translate the TDS protocol 
      data on the fly and the data is being captured, you would enter:</P>
  </DIV>
  <blockquote> 
    <DIV> 
      <PRE>
Ribo -l 2638 -t
</PRE>
    </DIV>
  </blockquote>
  <DIV> 
    <P>The data will be written to <I>outX.tds</I> where <VAR>X</VAR> matches 
      <I>capX.tds.</I></P>
    <P>To have Ribo translate captured TDS protocol data, you would enter:</P>
  </DIV>
  <blockquote> 
    <DIV> 
      <PRE>
Ribo cap0.tds tds0.out
</PRE>
    </DIV>
  </blockquote>
  <DIV> 
    <h1> <a name=MARKER-2-28></a><font face="Times New Roman, Times, serif" color="#0000A0">Using 
      the Ribo GUI</font> </h1>
    <P></P>
    <P>To start the Ribo graphical user interface and listen on local machine 
      port 2638, you would enter:</P>
  </DIV>
  <blockquote> 
    <DIV> 
      <PRE>
Ribo -gui -l 2638
</PRE>
    </DIV>
  </blockquote>
  <DIV> 
    <P>When you include the <B>-gui</B> parameter, you see this screen:</P>
    <P><IMG ALIGN=TOP SRC=ribo1.gif width="455" height="448"> 
    <P> 
    <P>If you specify the listen port, server host, and server port when you start 
      Ribo, these parameters are filled in for you on the GUI screen.</P>
    <P>To capture and translate data:</P>
    <OL compact>
      <LI VALUE="1. ">Select Preferences from the File menu. You see this dialog 
        box: 
    </OL>
    <P><IMG ALIGN=TOP SRC=ribo2.gif width="343" height="342"> 
    <P> 
    <OL compact>
      <LI VALUE="2. ">Enter or change the values shown in the dialog box, which 
        correspond to various command line parameters. If you specified a value 
        for these parameters when you started <B>Ribo</B> at the command line, 
        those values display in this dialog box. If you did not specify these 
        parameters, the program displays the default values. 
    </OL>
    <BLOCKQUOTE> 
      <UL compact>
        <LI><EM>Capture File Prefix</EM> - Corresponds to the <B>-c</B> (capture_file_prefix) 
          parameter. Specify the prefix added to the generated file name of the 
          captured data. 
        <LI><EM>Translate File Prefix</EM> - Corresponds to the <B>-t</B> (trans_file_prefix) 
          parameter). Specify the prefix added to the generated file name of the 
          translated data. 
        <LI><EM>Translation Filter File</EM> - Corresponds to the <B>-f </B>(filter_file) 
          parameter. Displays the file name of the filter you specified when you 
          started Ribo at the command line. See <a href="ribo-2.html#filters">Using 
          Filters</a> for more information.
        <LI><EM>Translate to a file</EM> - Also corresponds to the <B>-t</B> (trans_file_prefix) 
          parameter. Check this box to translate captured data to the TDS protocol's 
          text representation and save it to a file with the prefix you specified. 
        <LI>Display Translation in a window - Corresponds to the <B>-d</B> parameter. 
          Check this box to display translated data in the GUI while the data 
          is being captured. 
      </UL>
      See <A HREF="#MARKER-9-13">Table 1</A> for more details about the command 
      line parameters.</BLOCKQUOTE>
    <OL compact>
      <LI VALUE="3. ">Click OK. 
      <LI VALUE="4. ">Click Start Capture. 
      <LI VALUE="5. ">To stop the capture process click Stop Capture. You must 
        stop the capture process to change the host, ports, or Preferences. 
      <LI VALUE="6. ">When you finish, click End. 
    </OL>
  </DIV>
  <DIV> 
    <h1><font color="#000099"><a name="filters"></a>Using Filters</font></h1>
    <p>You can create a filter that will show some or every detail of the TDS 
      protocol data using the <b>-f</b> command parameter. If you do not specify 
      a filter file name, the default filter is used. To see the default filter 
      selections, start the Ribo GUI:</p>
    <pre>Ribo -gui -l 4000 -d
</pre>
    <p>When the GUI displays, select Edit Filter from the File menu. You see a 
      screen similar to this:</p>
    <p><img src="ribo3.gif" width="400" height="350"> </p>
    <p>The column on the left displays types of tokens; the column on the right 
      displays details available for some or all tokens. Selected items are highlighted 
      and represent the token details you want to see from the TDS protocol data.</p>
    <p><font color="#CC0000"><b>Every token that occurs legally in TDS version 
      5.0 or later is recognized by Ribo. </b></font><font color="#CC0000"><b>For 
      more information about TDS tokens, see the TDS 5.0 Functional Specification 
      at <a href="http://www.sybase.com/products/TDSfunctionalSpecForm.html">http://www.sybase.com/products/TDSfunctionalSpecForm.html</a>.</b></font></p>
    <p>The following table describes the items in the right column.</p>
    <table width="93%" border="1" cellspacing="0" cellpadding="5">
      <tr> 
        <td><b>DETAIL NAME</b></td>
        <td><b>DESCRIPTION</b></td>
      </tr>
      <tr> 
        <td>TOKEN_DETAILS</td>
        <td>Refers to information about the (single-byte) token itself, like its 
          hex value and whether it is fixed or variable length. If you do not select (highlight) this detail, only the token name is dumped. Pertains to all tokens.</td>
      </tr>
      <tr> 
        <td>LENGTH_DETAILS</td>
        <td>Refers to information about the various length fields found within 
          a token, including the overall token length. Pertains to all tokens.</td>
      </tr>
      <tr> 
        <td>DATA_DETAILS</td>
        <td>Refers to all details of the token beyond what is specified by TOKEN_DETAILS. 
          This is what the <a href="%20http://www.sybase.com/products/TDSfunctionalSpecForm.html">TDS 
          5.0 Specification</a> calls the "data stream" that follows the token 
          itself. Pertains to all tokens.</td>
      </tr>
      <tr> 
        <td>VERBOSE_CAP_DETAILS</td>
        <td>Specifies that the flags in a capability token are to be dumped in 
          "verbose" format, which indicates the name of each flag and its value. 
          If you do not select (highlight) this detail, the flags are dumped as 
          hex. Pertains only to CAPABILITY tokens. </td>
      </tr>
      <tr> 
        <td> PASSWORD_DETAILS</td>
        <td>Specifies that the password contained in the login record is to be 
          dumped. If you do not select (highlight) this detail, the password is 
          dumped. Pertains only to Login Record.</td>
      </tr>
      <tr> 
        <td colspan="2"><i>Selecting the following details when you have not selected 
          DATA_DETAILS will cause the details to be dumped anyway for certain 
          tokens. That is, these details override DATA_DETAILS.</i></td>
      </tr>
      <tr> 
        <td>SQL_TEXT_DETAILS </td>
        <td> Refers to the text of a SQL query. When you select (highlight) this 
          detail, it overrides DATA_DETAILS. Pertains only to LANGUAGE tokens.</td>
      </tr>
      <tr> 
        <td>ROW_DETAILS</td>
        <td>Refers to the row data of a row, param, alt-row or key token. If you 
          do not select (highlight) this detail, the data is not dumped. Specifying 
          this detail overrides DATA_DETAILS. Pertains only to ALTROW, KEY, PARAMS, 
          RPC, RETURN_VALUE and ROW tokens.</td>
      </tr>
      <tr> 
        <td>FORMAT_DETAILS</td>
        <td> Refers to the format data of a param format, row format, or alt row 
          format token. Specifying this detail overrides DATA_DETAILS. Pertains 
          only to ALTFMT, PARAMFMT, ROWFMT, RPC and RETURN_VALUE tokens.</td>
      </tr>
      <tr> 
        <td>RPC_DETAILS</td>
        <td> Overrides DATA_DETAILS for DBRPC tokens. Pertains only to DBRPC tokens.</td>
      </tr>
      <tr> 
        <td>CURSOR_DETAILS</td>
        <td> Overrides DATA_DETAILS for all cursor tokens. Pertains only to CURCLOSE, 
          CURDECLARE, CURDELETE, CURFETCH, CURINFO and CURUPDATE tokens.</td>
      </tr>
      <tr> 
        <td>EED_DETAILS</td>
        <td>Overrides DATA_DETAILS for EED tokens. Pertains to EED tokens only.</td>
      </tr>
    </table>
    <p><b>To create a custom filter:</b></p>
    </DIV>
  <ol>
    <li> 
      <DIV> 
        <p>Click on an item to highlight and select it; click again to deselect 
          it.</p>
      </DIV>
    </li>
    <li> 
      <DIV> 
        <p>Click OK to save your changes. A dialog box displays where you can 
          save the new filter.</p>
      </DIV>
    </li>
    <li> 
      <p>Type the file name under which to save your custom filter. The name can 
        be anything you want and doesn't require an extension; for example <i>TDS_1.filter</i> 
        or just <i>TDS1</i>.</p>
    </li>
    <li> 
      <p>Click Save.</p>
    </li>
  </ol>
  <DIV> 
    <p><b>To use a custom filter you have created, </b>enter something similar 
      to this at the command line:</p>
  </DIV>
  <blockquote>
    <DIV>
      <pre>ribo -l 4000 -gui -f TDS_1.filter -d</pre>
    </DIV>
  </blockquote>
  <DIV> 
    <h1><font face="Times New Roman, Times, serif" color="#0000A0"><a name="knownproblems"></a>Known 
      Problems </font></h1>
    <p></p>
    <p>This section describes problems that are scheduled to be fixed in a future 
      release of Ribo.</p>
    <ul compact>
      <li value="&middot; ">#197508 - DATETIMN conversion throws an exception. 
    </ul>
    <blockquote>When dumping a file containing a row token with a DATETIMN column, 
      an exception is thrown. Ribo continues to function, but you never see the 
      row token for that row. This is specific to JDK 1.1.8.</blockquote>
    </DIV>
  <DIV> 
    <HR noshade SIZE=2 ALIGN=LEFT>
    <ADDRESS></ADDRESS>
    <P></P>
    <P> <a href="ribo-1.html"><img align=BOTTOM src=prev.gif></a>&nbsp;&nbsp;<a href="ribo-2.html" target="_top"><img align=BOTTOM src=top.gif></a> 
    </P>
    <P> 
    <ADDRESS> </ADDRESS>
    <H5>Copyright 1999 &copy; Sybase, Inc. All Rights Reserved.</H5>
  </DIV>
</BLOCKQUOTE>
</BODY>
</HTML>





